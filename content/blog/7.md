---
title: Migrating from Nuxt Content Assets to Nuxt Content V3
short: Solving asset management challenges when upgrading to Nuxt Content V3
tags:
  - Nuxt Content
  - Nuxt.js
  - Migration Guide
  - Asset Management
created: 2025-03-01 22:00
updated: 2025-03-01 22:00
---

# The Challenge

When migrating to Nuxt Content V3 for LLM compatibility (specifically for [Nuxt LLM](https://nuxt.com/modules/llms)), we lose the convenient asset management provided by [Nuxt Content Assets](https://nuxt.com/modules/content-assets). This guide explains how to maintain organized blog assets while upgrading.

## Understanding the Problem

In Nuxt Content V2, assets were automatically handled within content folders. However, V3 requires manual asset management. The solution? A custom Nitro plugin that mirrors our content structure to the public directory.

## Implementation

### 1. Configure Nitro Plugin

First, update your `nuxt.config.ts`:

```ts
export default defineNuxtConfig({
  nitro: {
    plugins: ['~/scripts/copy-content-images']
  }
})
```

### 2. Create the Plugin

Create `scripts/copy-content-images.ts`:

```typescript
import { promises as fs } from 'fs'
import { join, relative, dirname } from 'path'

// Helper to check file existence
async function exists(path: string) {
  try {
    await fs.access(path)
    return true
  } catch {
    return false
  }
}

async function copyPngFiles(sourcePath: string, targetPath: string) {
  try {
    const entries = await fs.readdir(sourcePath, { withFileTypes: true })

    for (const entry of entries) {
      const srcPath = join(sourcePath, entry.name)
      
      if (entry.isDirectory()) {
        await copyPngFiles(srcPath, targetPath)
      } else if (entry.name.toLowerCase().endsWith('.png')) {
        const relPath = relative('./content', srcPath)
        const destPath = join(targetPath, relPath)
        
        await fs.mkdir(dirname(destPath), { recursive: true })
        await fs.copyFile(srcPath, destPath)
        console.log(`‚úì Asset copied: ${relPath}`)
      }
    }
  } catch (error) {
    console.error('‚ùå Error copying assets:', error)
  }
}

export default defineNitroPlugin(async () => {
  const contentDir = './content'
  const outputDir = './.output/public'

  if (await exists(contentDir)) {
    console.log('üìÅ Starting asset migration...')
    await copyPngFiles(contentDir, outputDir)
    console.log('‚ú® Asset migration complete')
  }
})
```

## How It Works

1. The plugin activates during the Nuxt build process
2. It recursively scans your `content` directory for PNG files
3. Maintains the exact folder structure when copying to `.output/public`
4. Provides console feedback during the build process

## Benefits

- Maintains organized content structure
- Automatic asset copying during build
- Compatible with Nuxt Content V3 and Nuxt LLM
- Zero runtime overhead

## Limitations

- Currently only handles PNG files (modify the code to support other formats)
- Assets must be rebuilt when content changes
- Manual cleanup of old assets required

## Future Improvements

Consider these enhancements:

- Add support for more image formats (jpg, webp, etc.)
- Implement file watching for development
- Add hash-based caching
- Create a reusable npm package

## Resources

- [Nuxt Content V3 Documentation](https://content.nuxt.com/)
- [Nuxt LLM Module](https://nuxt.com/modules/llms)
- [Nuxt Content Assets (Legacy)](https://nuxt.com/modules/content-assets)
